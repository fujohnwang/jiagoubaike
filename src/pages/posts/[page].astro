---
import { ViewTransitions } from 'astro:transitions';
import Search from "astro-pagefind/components/Search";

export async function getStaticPaths({ paginate }) {
	const blogs = (await Astro.glob('./*.md')).filter(f=> !f.file.endsWith("test.md"))
					.sort((a, b) => Date.parse(b.frontmatter.pubDate) - Date.parse(a.frontmatter.pubDate));
	return paginate(blogs, { 
		pageSize: 11
	});
	// return paginate(blogs.sort((a, b) => new Date(a.frontmatter.date) - new Date(b.frontmatter.date)).reverse(), { pageSize: 11 });
}
const { page } = Astro.props;
// const pathname = new URL(Astro.request.url).pathname.split('/');
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta author="王福强"/>
    <meta keywords="架构百科" />
    <meta description="架构百科内容列表"/>
    <link rel="icon" type="image/svg+xml" href="https://afoo.me/favicon.svg">
	<link rel="canonical" href={canonicalURL} />
    <title>架构百科文章列表</title>
    <script src="https://unpkg.com/htmx.org@1.9.5"></script>
    <!-- <ViewTransitions/> -->
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3687639021943715"
     crossorigin="anonymous"></script>
  </head>
  <body>
	<div class="container mx-auto p-6 w-full lg:w-1/2">
		<nav class="space-x-6 mt-6 mb-12">
		  <a href="/">Home</a>
		  <a href="https://afoo.me">Author</a>
		  <a href="https://edu.afoo.me">AI Courses</a>
		  <a href="https://store.afoo.me">Fuqiang Store</a>
		</nav>

		<main class="prose lg:prose-xl mt-6 mx-auto w-full max-w-screen-xl">
			<h1><a href="/">架构百科</a> 文章列表</h1>

			<Search id="search" className="pagefind-ui" uiOptions={{ showImages: false }} />

		<section class="section blog-section" id="blog-section">
			<div class="container">
			  <div id="search" class="ml-3 p-4 -mt-8"></div>
			  <ul class="blogs list-none">
				{page.data.map((blog) =>
				  <li>
					<!-- 
					<article class="blog">          

					  <img src={blog.frontmatter.image.url} alt="blog.frontmatter.image.alt" />
					
					  <h2><a href={blog.url}>{blog.frontmatter.title}</a></h2>
					  <p>{blog.frontmatter.description} 👉 <a href={blog.url} class="text-sm">Read more</a></p>
					</article>            
					-->
					<article
					  class="hover:animate-background rounded-xl bg-gradient-to-r from-green-300 via-blue-500 to-purple-600 p-0.5 shadow-xl transition hover:bg-[length:400%_400%] hover:shadow-sm hover:[animation-duration:_4s]"
					>
					  <div class="rounded-[10px] bg-white p-4 !pt-20 sm:p-6">
					    <time datetime={blog.frontmatter.pubDate.substring(0,10)} class="block text-xs text-gray-500">{blog.frontmatter.pubDate.substring(0,10)}</time>

					    <a href={blog.url}>
					      <h3 class="!mt-0.5 text-lg font-medium text-gray-900">
					        {blog.frontmatter.title}
					      </h3>
					    </a>

					  </div>
					</article>
				  </li>
				)}
			  </ul>

			  <div class="flex justify-center mx-auto my-6">
				<div class="inline-flex items-center justify-center gap-3">
					<a href={page.url.prev ? page.url.prev : '#'} class="inline-flex size-8 items-center justify-center rounded border border-gray-100 bg-white text-gray-900 rtl:rotate-180">
					  <span class="sr-only">Prev Page</span>
					  <svg xmlns="http://www.w3.org/2000/svg" class="size-3" viewBox="0 0 20 20" fill="currentColor">
						<path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
					  </svg>
					</a>
				
					<p class="text-xs text-gray-900">
						{page.currentPage}
							  <span class="mx-0.25">/</span>
						  {page.lastPage}
					</p>
				
					<a href={page.url.next ? page.url.next : '#'} class="inline-flex size-8 items-center justify-center rounded border border-gray-100 bg-white text-gray-900 rtl:rotate-180">
					  <span class="sr-only">Next Page</span>
					  <svg xmlns="http://www.w3.org/2000/svg" class="size-3" viewBox="0 0 20 20" fill="currentColor">
						<path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
					  </svg>
					</a>
				  </div>
			  </div>

			</div>
		  </section>
		 


    </main>

	<section class="overflow-x-clip bg-zinc-50 py-16 md:py-24">
        <div class="relative mx-auto w-full max-w-screen-xl px-4">
          <div class="relative z-10 w-full">
            <div class="mx-auto max-w-screen-md">
              <h2 class="mb-4 text-center text-4xl font-bold md:text-5xl">欢迎加入<a href="https://afoo.me/kb.html" class="border-b">「福强私学」</a></h2>
              <p class="mx-auto mb-8 w-full text-center text-lg leading-8 text-zinc-700 md:w-5/6 md:text-xl">一起探索「技术、商业与人」</p>
            </div>
            <div class="mx-auto mt-6 w-full md:mt-12 md:w-4/5">
              <img alt="footer img for kb.afoo.me" loading="lazy" width="2911" height="1961" decoding="async" data-nimg="1" class="mx-auto rounded-lg object-contain shadow-lg sm:rounded-2xl lg:rounded-3xl" style="color:transparent" src="https://og.afoo.me/?url=footer" />
            </div>
          </div>
        </div>
      </section>
	  
	<hr class="my-6"/>

    <div hx-get="https://toolfooter.afoo.me/" hx-trigger="revealed, load delay:3s"/>
         <footer class="mt-12">
        <div>
          <img
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACWAAAAAYAQMAAABEalRSAAAABlBMVEX///9TU1NYzE1OAAAAAXRSTlMAQObYZgAAAOtJREFUeF7tljEKwzAMRb/J0CWgI/QKOYAh1+pUcjQfpUfw2MFEHVyDQSQmQUNM9AYNcobnh4egU+YVqhAvZSpgsfolPnSv5d0nz3vHslgUdK81RLzyvHcsi+WBNxQh4Ln8pw4Wi7skAg9mXgHMrEACXJnbHIllsbqGAtwXhnYswzFzwPWxWEPc2CexoobkHM4ZpD6s2loWiyIEEwCChIomMiMEHqgP573C9eHkc5VLWh3XsljnGVoLWVl+31bp38piTVVuihtPOAm9kcRLbrFjEvqwamtZLK5eI8sSan9rXEK0LcNFrY5oWawf59S7YSRD7eMAAAAASUVORK5CYII="
            style="width: 100%;"
          />
          <div class="mt-3 text-center">
            Copyright © 2023 - <a href="https://afoo.me">Fuqiang Wang</a> All
            Rights Reserved.
          </div>
          <div class="mx-auto flex flex-col justify-center self-center items-center">
            <a href="https://x.com/afoo_me" class="flex inline items-center mt-2">
              <svg
                viewBox="0 0 24 24"
                width="2rem"
                height="2rem"
                astro-icon="tabler:brand-twitter"
              >
                <path
                  fill="none"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84 0 0 0 .497-3.753C20.18 7.773 21.692 5.25 22 4.009z"
                >
                </path>
              </svg>
               @afoo_me</a>
          </div>
        </div>
      </footer>
	</div>
	<script is:inline="true">
		// Set "light" theme as default
		// if (!localStorage.theme) {
		//   localStorage.theme = "light";
		// }
	
		if (
		  localStorage.theme === 'dark' ||
		  (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
		) {
		  document.documentElement.classList.add('dark');
		} else {
		  document.documentElement.classList.remove('dark');
		}
	
		function attachEvent(selector, event, fn) {
		  const matches = document.querySelectorAll(selector);
		  if (matches && matches.length) {
			matches.forEach((elem) => {
			  elem.addEventListener(event, () => fn(elem), false);
			});
		  }
		}
	
		window.onload = function () {
		  attachEvent('[data-aw-toggle-menu]', 'click', function (elem) {
			elem.classList.toggle('expanded');
			document.body.classList.toggle('overflow-hidden');
			document.getElementById('header')?.classList.toggle('h-screen');
			document.querySelector('#header nav')?.classList.toggle('hidden');
		  });
	
		  attachEvent('[data-aw-toggle-color-scheme]', 'click', function () {
			document.documentElement.classList.toggle('dark');
			localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
		  });
	
		  attachEvent('[data-aw-social-share]', 'click', function (elem) {
			const network = elem.getAttribute('data-aw-social-share');
			const url = encodeURIComponent(elem.getAttribute('data-aw-url'));
			const text = encodeURIComponent(elem.getAttribute('data-aw-text'));
	
			let href;
			switch (network) {
			  case 'facebook':
				href = `https://www.facebook.com/fujohnwang`;
				break;
			  case 'twitter':
				href = `https://twitter.com/fujohnwang`;
				break;
			  case 'linkedin':
				href = `https://www.linkedin.com/in/fuqiangwang/`;
				break;
			  case 'mail':
				href = `mailto:fujohnwang@gmail.com?subject=%22${text}%22&body=${text}%20${url}`;
				break;
	
			  default:
				return;
			}
	
			const newlink = document.createElement('a');
			newlink.target = '_blank';
			newlink.href = href;
			newlink.click();
		  });
		};
		window.onpageshow = function () {
		  const elem = document.querySelector('[data-aw-toggle-menu]');
		  if (elem) {
			elem.classList.remove('expanded');
		  }
		  document.body.classList.remove('overflow-hidden');
		  document.getElementById('header')?.classList.remove('h-screen');
		  document.querySelector('#header nav')?.classList.add('hidden');
		};
		// pagefind search section
		window.addEventListener('DOMContentLoaded', (event) => {
		  new PagefindUI({ element: '#search'});
		});

	    window.addEventListener('keydown', (event) => {
	        if (event.key === '/' || event.key === '.') {
	            event.preventDefault();
	            document.querySelector('div#search input').focus();
	        }
	    });
	  </script>

		<script src="https://formspree.io/js/formbutton-v1.min.js" defer></script>
		<script>
		  /* paste this line in verbatim */
		  window.formbutton=window.formbutton||function(){(formbutton.q=formbutton.q||[]).push(arguments)};
		  /* customize formbutton below*/     
		  formbutton("create", {
		    action: "https://formspree.io/f/xknlpkkd",
		    title: "有什么可以帮到您？💕💕💕 How can I help you?",
		    fields: [
		      { 
		        type: "email", 
		        label: "您的电子邮箱（方便与您联系）:", 
		        name: "email",
		        required: true,
		        placeholder: "your@email.com"
		      },
		      {
		        type: "textarea",
		        label: "您想提交的反馈和询问信息:",
		        name: "message",
		        placeholder: "What's on your mind?",
		      },
		      { type: "submit" }      
		    ],
		    styles: {
		      title: {
		        backgroundColor: "blue"
		      },
		      button: {
		        backgroundColor: "blue"
		      }
		    }
		  });
		</script>

  </body>
</html>

<style is:global>
	.dark {
		--pagefind-ui-primary: #eeeeee;
		--pagefind-ui-text: #eeeeee;
		--pagefind-ui-background: #152028;
		--pagefind-ui-border: #152028;
		--pagefind-ui-tag: #152028;
	}
</style>